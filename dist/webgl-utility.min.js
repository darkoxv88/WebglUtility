/**
  * 
  * @author Darko Petrovic
  * @Link Facebook: https://www.facebook.com/WitchkingOfAngmarr
  * @Link GitHub: https://github.com/darkoxv88
  * 
  
  Permission is hereby granted, free of charge, to any person obtaining a copy
	of this software and associated documentation files (the "Software"), to deal
	in the Software without restriction, including without limitation the rights
	to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
	copies of the Software, and to permit persons to whom the Software is
	furnished to do so, subject to the following conditions:
	The above copyright notice and this permission notice shall be included in
	all copies or substantial portions of the Software.

	THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
	IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
	FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
	AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
	LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
	OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
	THE SOFTWARE.


exports:

  window.WebglUtility;

**/

(()=>{"use strict";var t="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{};function e(){return t}function s(t){try{return(t=parseInt(t))>255?255:t<0?0:t}catch(t){return console.error(t),0}}const r="undefined"!=typeof Float32Array?Float32Array:Array;class i{constructor(t){this.vec=new r(2);for(let t=0;t<this.vec.length;t++)this.vec[t]=0;return t?t instanceof i?(this.vec[0]=t.x,this.vec[1]=t.y,this):t instanceof r||Array.isArray(t)?(this.vec[0]=t[0],this.vec[1]=t[1],this):this:this}get x(){return this.vec[0]}get y(){return this.vec[1]}size(){return this.vec.length}iterate(t){try{for(let e=0;e<this.vec.length;e++)t(e,this.vec[e])}catch(t){console.log(t)}}toString(){return this.vec.toString()}toArray(){return this.vec.slice()}get(t){try{return this.vec[t]}catch(t){return 0}}set(t,e){"number"==typeof t&&"number"==typeof e&&(t>1||(this.vec[t]=e))}add(t){return i.add(this,t)}sub(t){return i.sub(this,t)}normalize(){return i.normalize(this)}static getConstructionObject(){return r}static copy(t){try{return new i(t)}catch(t){return null}}static empty(){return new i}static create(t,e){const s=this.empty();return s.set(0,t),s.set(1,e),s}static add(t,e){return this.create(t.x+e.x,t.y+e.y)}static sub(t,e){return this.create(t.x-e.x,t.y-e.y)}static mul(t,e){return this.create(t.x*e.x,t.y*e.y)}static div(t,e){return this.create(t.x/e.x,t.y/e.y)}static min(t,e){return this.create(Math.min(t.x,e.x),Math.min(t.y,e.y))}static max(t,e){return this.create(Math.max(t.x,e.x),Math.max(t.y,e.y))}static scale(t,e){return this.create(t.x*e,t.y*e)}static distance(t,e){const s=e.x-t.x,r=e.y-t.y;return s*s+r*r}static distanceSqrt(t,e){return Math.sqrt(this.distance(t,e))}static negate(t){return this.create(0-t.x,0-t.y)}static dotProduct(t,e){return t.x*e.x+t.y*e.y}static vecLenght(t){return Math.sqrt(this.dotProduct(t,t))}static inverse(t){return this.create(1/t.x,1/t.y)}static normalize(t){const e=this.vecLenght(t);return 0===e?this.create(0,0):this.create(t.x/e,t.y/e)}}class a{constructor(t){this.vec=new r(3);for(let t=0;t<this.vec.length;t++)this.vec[t]=0;return t?t instanceof a?(this.vec[0]=t.x,this.vec[1]=t.y,this.vec[2]=t.z,this):t instanceof r||Array.isArray(t)?(this.vec[0]=t[0],this.vec[1]=t[1],this.vec[2]=t[2],this):this:this}get x(){return this.vec[0]}get y(){return this.vec[1]}get z(){return this.vec[2]}size(){return this.vec.length}iterate(t){try{for(let e=0;e<this.vec.length;e++)t(e,this.vec[e])}catch(t){console.log(t)}}toString(){return this.vec.toString()}toArray(){return this.vec.slice()}toVec2(){return i.create(this.x,this.y)}xy(){return i.create(this.x,this.y)}get(t){try{return this.vec[t]}catch(t){return 0}}set(t,e){"number"==typeof t&&"number"==typeof e&&(t>2||(this.vec[t]=e))}add(t){return a.add(this,t)}sub(t){return a.sub(this,t)}normalize(){return a.normalize(this)}static getConstructionObject(){return r}static copy(t){try{return new a(t)}catch(t){return null}}static empty(){return new a}static create(t,e,s){const r=this.empty();return r.set(0,t),r.set(1,e),r.set(2,s),r}static add(t,e){return this.create(t.x+e.x,t.y+e.y,t.z+e.z)}static sub(t,e){return this.create(t.x-e.x,t.y-e.y,t.z-e.z)}static mul(t,e){return this.create(t.x*e.x,t.y*e.y,t.z*e.z)}static div(t,e){return this.create(t.x/e.x,t.y/e.y,t.z/e.z)}static min(t,e){return this.create(Math.min(t.x,e.x),Math.min(t.y,e.y),Math.min(t.z,e.z))}static max(t,e){return this.create(Math.max(t.x,e.x),Math.max(t.y,e.y),Math.max(t.z,e.z))}static scale(t,e){return this.create(t.x*e,t.y*e,t.z*e)}static distance(t,e){const s=e.x-t.x,r=e.y-t.y,i=e.z-t.z;return s*s+r*r+i*i}static distanceSqrt(t,e){return Math.sqrt(this.distance(t,e))}static negate(t){return this.create(0-t.x,0-t.y,0-t.z)}static dotProduct(t,e){return t.x*e.x+t.y*e.y+t.z*e.z}static vecLenght(t){return Math.sqrt(this.dotProduct(t,t))}static inverse(t){return this.create(1/t.x,1/t.y,1/t.z)}static normalize(t){const e=this.vecLenght(t);return 0===e?this.create(0,0,0):this.create(t.x/e,t.y/e,t.z/e)}static crossProduct(t,e){return this.create(t.y*e.z-t.z*e.y,t.z*e.x-t.x*e.z,t.x*e.y-t.y*e.x)}}class n{constructor(t){this.vec=new r(4);for(let t=0;t<this.vec.length;t++)this.vec[t]=0;return t?t instanceof n?(this.vec[0]=t.x,this.vec[1]=t.y,this.vec[2]=t.z,this.vec[3]=t.w,this):t instanceof r||Array.isArray(t)?(this.vec[0]=t[0],this.vec[1]=t[1],this.vec[2]=t[2],this.vec[3]=t[3],this):this:this}get x(){return this.vec[0]}get y(){return this.vec[1]}get z(){return this.vec[2]}get w(){return this.vec[3]}size(){return this.vec.length}iterate(t){try{for(let e=0;e<this.vec.length;e++)t(e,this.vec[e])}catch(t){console.log(t)}}toString(){return this.vec.toString()}toArray(){return this.vec.slice()}toVec2(){return i.create(this.x,this.y)}xy(){return i.create(this.x,this.y)}toVec3(){return a.create(this.x,this.y,this.z)}xyz(){return a.create(this.x,this.y,this.z)}get(t){try{return this.vec[t]}catch(t){return 0}}set(t,e){"number"==typeof t&&"number"==typeof e&&(t>3||(this.vec[t]=e))}add(t){return n.add(this,t)}sub(t){return n.sub(this,t)}normalize(){return n.normalize(this)}static getConstructionObject(){return r}static copy(t){try{return new n(t)}catch(t){return null}}static empty(){return new n}static create(t,e,s,r){const i=this.empty();return i.set(0,t),i.set(1,e),i.set(2,s),i.set(3,r),i}static add(t,e){return this.create(t.x+e.x,t.y+e.y,t.z+e.z,t.w+e.w)}static sub(t,e){return this.create(t.x-e.x,t.y-e.y,t.z-e.z,t.w-e.w)}static mul(t,e){return this.create(t.x*e.x,t.y*e.y,t.z*e.z,t.w*e.w)}static div(t,e){return this.create(t.x/e.x,t.y/e.y,t.z/e.z,t.w/e.w)}static min(t,e){return this.create(Math.min(t.x,e.x),Math.min(t.y,e.y),Math.min(t.z,e.z),Math.min(t.w,e.w))}static max(t,e){return this.create(Math.max(t.x,e.x),Math.max(t.y,e.y),Math.max(t.z,e.z),Math.max(t.w,e.w))}static scale(t,e){return this.create(t.x*e,t.y*e,t.z*e,t.w*e)}static distance(t,e){const s=e.x-t.x,r=e.y-t.y,i=e.z-t.z,a=e.w-t.w;return s*s+r*r+i*i+a*a}static distanceSqrt(t,e){return Math.sqrt(this.distance(t,e))}static negate(t){return this.create(0-t.x,0-t.y,0-t.z,0-t.w)}static dotProduct(t,e){return t.x*e.x+t.y*e.y+t.z*e.z+t.w*e.w}static vecLenght(t){return Math.sqrt(this.dotProduct(t,t))}static inverse(t){return this.create(1/t.x,1/t.y,1/t.z,1/t.w)}static normalize(t){const e=this.vecLenght(t);return 0===e?this.create(0,0,0,0):this.create(t.x/e,t.y/e,t.z/e,t.w/e)}}function c(t,e,s){for(let r=0;r<e;r++)for(let i=0;i<e;i++)s.set(i*e+r,t.get(r*e+i))}function h(t,e,s,r){for(let i=0;i<s;i++)for(let a=0;a<s;a++){const n=i*s+a;let c=0;for(let r=0;r<s;r++)c+=t.get(i*s+r)*e.get(r*s+a);r.set(n,c)}}class o{constructor(t){this.mat=new r(4);for(let t=0;t<4;t++)this.mat[t]=0;return t?t instanceof o?(this.mat[0]=t.get(0),this.mat[1]=t.get(1),this.mat[2]=t.get(2),this.mat[3]=t.get(3),this):t instanceof r||Array.isArray(t)?(this.mat[0]=t[0],this.mat[1]=t[1],this.mat[2]=t[2],this.mat[3]=t[3],this):this:this}size(){return this.mat.length}iterate(t){try{for(let e=0;e<this.mat.length;e++)t(e,this.mat[e])}catch(t){console.log(t)}}toString(){return this.mat.toString()}toArray(){return this.mat.slice()}get(t){try{return this.mat[t]}catch(t){return 0}}set(t,e){"number"==typeof t&&"number"==typeof e&&(t>3||(this.mat[t]=e))}transpose(){return o.transpose(this)}static getConstructionObject(){return r}static copy(t){try{return new o(t)}catch(t){return null}}static empty(){return new o}static createIdentityMatrix(){const t=this.empty();return t.set(0,1),t.set(1,0),t.set(2,0),t.set(3,1),t}static transpose(t){const e=this.empty();return c(t,2,e),e}static determinant(t){return t.get(0)*t.get(3)-t.get(2)*t.get(1)}static invert(t){const e=this.empty(),s=1/this.determinant(t);return e.set(0,t.get(3)*s),e.set(1,-t.get(1)*s),e.set(2,-t.get(2)*s),e.set(3,t.get(0)*s),e}static mul(t,e){const s=this.empty();return h(t,e,2,s),s}static scale(t,e){const s=this.empty();return s.set(0,t.get(0)*e.x),s.set(1,t.get(1)*e.x),s.set(2,t.get(2)*e.y),s.set(3,t.get(3)*e.y),s}static adjugate(t){const e=this.empty();return e.set(0,t.get(3)),e.set(1,0-t.get(1)),e.set(2,0-t.get(2)),e.set(3,t.get(0)),e}}class g{constructor(t){this.mat=new r(9);for(let t=0;t<9;t++)this.mat[t]=0;return t?t instanceof g?(this.mat[0]=t.get(0),this.mat[1]=t.get(1),this.mat[2]=t.get(2),this.mat[3]=t.get(3),this.mat[4]=t.get(4),this.mat[5]=t.get(5),this.mat[6]=t.get(6),this.mat[7]=t.get(7),this.mat[8]=t.get(8),this):t instanceof r||Array.isArray(t)?(this.mat[0]=t[0],this.mat[1]=t[1],this.mat[2]=t[2],this.mat[3]=t[3],this.mat[4]=t[4],this.mat[5]=t[5],this.mat[6]=t[6],this.mat[7]=t[7],this.mat[8]=t[8],this):this:this}size(){return this.mat.length}iterate(t){try{for(let e=0;e<this.mat.length;e++)t(e,this.mat[e])}catch(t){console.log(t)}}toString(){return this.mat.toString()}toArray(){return this.mat.slice()}get(t){try{return this.mat[t]}catch(t){return 0}}set(t,e){"number"==typeof t&&"number"==typeof e&&(t>8||(this.mat[t]=e))}transpose(){return g.transpose(this)}static getConstructionObject(){return r}static copy(t){try{return new g(t)}catch(t){return null}}static empty(){return new g}static createIdentityMatrix(){const t=this.empty();return t.set(0,1),t.set(1,0),t.set(2,0),t.set(3,0),t.set(4,1),t.set(5,0),t.set(6,0),t.set(7,0),t.set(8,1),t}static transpose(t){const e=this.empty();return c(t,3,e),e}static determinant(t){return t.get(0)*(t.get(8)*t.get(4)-t.get(5)*t.get(7))+t.get(1)*(t.get(5)*t.get(6)-t.get(8)*t.get(3))+t.get(2)*(t.get(7)*t.get(3)-t.get(4)*t.get(6))}static invert(t){const e=this.empty(),s=1/this.determinant(t);return e.set(0,(t.get(8)*t.get(4)-t.get(5)*t.get(7))*s),e.set(1,(-t.get(8)*t.get(1)+t.get(2)*t.get(7))*s),e.set(2,(t.get(5)*t.get(1)-t.get(2)*t.get(4))*s),e.set(3,(-t.get(8)*t.get(3)+t.get(5)*t.get(6))*s),e.set(4,(t.get(8)*t.get(0)-t.get(2)*t.get(6))*s),e.set(5,(-t.get(5)*t.get(0)+t.get(2)*t.get(3))*s),e.set(6,(t.get(7)*t.get(3)-t.get(4)*t.get(6))*s),e.set(7,(-t.get(7)*t.get(0)+t.get(1)*t.get(6))*s),e.set(8,(t.get(4)*t.get(0)-t.get(1)*t.get(3))*s),e}static mul(t,e){const s=this.empty();return h(t,e,3,s),s}static scale(t,e){const s=this.empty();return s.set(0,t.get(0)*e.x),s.set(1,t.get(1)*e.x),s.set(2,t.get(2)*e.x),s.set(3,t.get(3)*e.y),s.set(4,t.get(4)*e.y),s.set(5,t.get(5)*e.y),s.set(6,t.get(6)*e.z),s.set(7,t.get(7)*e.z),s.set(8,t.get(8)*e.z),s}}class u{constructor(t){this.mat=new r(16);for(let t=0;t<16;t++)this.mat[t]=0;return t?t instanceof u?(this.mat[0]=t.get(0),this.mat[1]=t.get(1),this.mat[2]=t.get(2),this.mat[3]=t.get(3),this.mat[4]=t.get(4),this.mat[5]=t.get(5),this.mat[6]=t.get(6),this.mat[7]=t.get(7),this.mat[8]=t.get(8),this.mat[9]=t.get(9),this.mat[10]=t.get(10),this.mat[11]=t.get(11),this.mat[12]=t.get(12),this.mat[13]=t.get(13),this.mat[14]=t.get(14),this.mat[15]=t.get(15),this):t instanceof r||Array.isArray(t)?(this.mat[0]=t[0],this.mat[1]=t[1],this.mat[2]=t[2],this.mat[3]=t[3],this.mat[4]=t[4],this.mat[5]=t[5],this.mat[6]=t[6],this.mat[7]=t[7],this.mat[8]=t[8],this.mat[9]=t[9],this.mat[10]=t[10],this.mat[11]=t[11],this.mat[12]=t[12],this.mat[13]=t[13],this.mat[14]=t[14],this.mat[15]=t[15],this):void 0:this}size(){return this.mat.length}iterate(t){try{for(let e=0;e<this.mat.length;e++)t(e,this.mat[e])}catch(t){console.log(t)}}toString(){return this.mat.toString()}toArray(){return this.mat.slice()}get(t){try{return this.mat[t]}catch(t){return 0}}set(t,e){"number"==typeof t&&"number"==typeof e&&(t>15||(this.mat[t]=e))}transpose(){return u.transpose(this)}transformVector(t){const e=n.empty();e.set(0,0),e.set(1,0),e.set(2,0),e.set(3,0);for(var s=0;s<4;++s)for(var r=0;r<4;++r)e.set(s,e.get(s)+t.get(r)*this.get(4*r+s));return e}transformPoint(t){const e=t.x*this.get(3)+t.y*this.get(7)+t.z*this.get(11)+this.get(15);return a.create((t.x*this.get(0)+t.y*this.get(4)+t.z*this.get(8)+this.get(12))/e,(t.x*this.get(1)+t.y*this.get(5)+t.z*this.get(9)+this.get(13))/e,(t.x*this.get(2)+t.y*this.get(6)+t.z*this.get(10)+this.get(14))/e)}transformNormal(t){const e=u.inverse(this);return a.create(t.x*e.get(0)+t.y*e.get(1)+t.z*e.get(2),t.x*e.get(4)+t.y*e.get(5)+t.z*e.get(6),t.x*e.get(8)+t.y*e.get(9)+t.z*e.get(10))}static getConstructionObject(){return r}static copy(t){try{return new u(t)}catch(t){return null}}static empty(){return new u}static createIdentityMatrix(){const t=this.empty();return t.set(0,1),t.set(1,0),t.set(2,0),t.set(3,0),t.set(4,0),t.set(5,1),t.set(6,0),t.set(7,0),t.set(8,0),t.set(9,0),t.set(10,1),t.set(11,0),t.set(12,0),t.set(13,0),t.set(14,0),t.set(15,1),t}static createPerspective(t,e,s,r){const i=Math.tan(.5*Math.PI-.5*t),a=1/(s-r),n=this.empty();return n.set(0,i/e),n.set(1,0),n.set(2,0),n.set(3,0),n.set(4,0),n.set(5,i),n.set(6,0),n.set(7,0),n.set(8,0),n.set(9,0),n.set(10,(s+r)*a),n.set(11,-1),n.set(12,0),n.set(13,0),n.set(14,0),n.set(15,s*r*a*2),n}static createOrthographic(t,e,s,r,i,a){const n=this.empty();return n.set(0,2/(e-t)),n.set(1,0),n.set(2,0),n.set(3,0),n.set(4,0),n.set(5,2/(r-s)),n.set(6,0),n.set(7,0),n.set(8,0),n.set(9,0),n.set(10,2/(i-a)),n.set(11,0),n.set(12,(t+e)/(t-e)),n.set(13,(s+r)/(s-r)),n.set(14,(i+a)/(i-a)),n.set(15,1),n}static createFrustum(t,e,s,r,i,a){const n=e-t,c=r-s,h=a-i,o=this.empty();return o.set(0,2*i/n),o.set(1,0),o.set(2,0),o.set(3,0),o.set(4,0),o.set(5,2*i/c),o.set(6,0),o.set(7,0),o.set(8,(t+e)/n),o.set(9,(r+s)/c),o.set(10,-(a+i)/h),o.set(11,-1),o.set(12,0),o.set(13,0),o.set(14,-2*i*a/h),o.set(15,0),o}static createTranslation(t,e,s){const r=this.empty();return r.set(0,1),r.set(1,0),r.set(2,0),r.set(3,0),r.set(4,0),r.set(5,1),r.set(6,0),r.set(7,0),r.set(8,0),r.set(9,0),r.set(10,1),r.set(11,0),r.set(12,t),r.set(13,e),r.set(14,s),r.set(15,1),r}static createRotationX(t){const e=this.empty(),s=Math.cos(t),r=Math.sin(t);return e.set(0,s),e.set(1,0),e.set(2,-1*r),e.set(3,0),e.set(4,0),e.set(5,1),e.set(6,0),e.set(7,0),e.set(8,r),e.set(9,0),e.set(10,s),e.set(11,0),e.set(12,0),e.set(13,0),e.set(14,0),e.set(15,1),e}static createRotationZ(t){const e=this.empty(),s=Math.cos(t),r=Math.sin(t);return e.set(0,s),e.set(1,r),e.set(2,0),e.set(3,0),e.set(4,-1*r),e.set(5,s),e.set(6,0),e.set(7,0),e.set(8,0),e.set(9,0),e.set(10,1),e.set(11,0),e.set(12,0),e.set(13,0),e.set(14,0),e.set(15,1),e}static createRotationY(t){const e=this.empty(),s=Math.cos(t),r=Math.sin(t);return e.set(0,1),e.set(1,0),e.set(2,0),e.set(3,0),e.set(4,0),e.set(5,s),e.set(6,r),e.set(7,0),e.set(8,0),e.set(9,-1*r),e.set(10,s),e.set(11,0),e.set(12,0),e.set(13,0),e.set(14,0),e.set(15,1),e}static createAxisRotation(t,e){const s=this.empty(),r=Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z),i=t.x/r,a=t.y/r,n=t.z/r,c=i*i,h=a*a,o=n*n,g=Math.cos(e),u=Math.sin(e),y=1-g;return s.set(0,c+(1-c)*g),s.set(1,i*a*y+n*u),s.set(2,i*n*y-a*u),s.set(3,0),s.set(4,i*a*y-n*u),s.set(5,h+(1-h)*g),s.set(6,a*n*y+i*u),s.set(7,0),s.set(8,i*n*y+a*u),s.set(9,a*n*y-i*u),s.set(10,o+(1-o)*g),s.set(11,0),s.set(12,0),s.set(13,0),s.set(14,0),s.set(15,1),s}static createScalingMat(t){const e=this.empty();return e.set(0,t.x),e.set(1,0),e.set(2,0),e.set(3,0),e.set(4,0),e.set(5,t.y),e.set(6,0),e.set(7,0),e.set(8,0),e.set(9,0),e.set(10,t.z),e.set(11,0),e.set(12,0),e.set(13,0),e.set(14,0),e.set(15,1),e}static transpose(t){const e=this.empty();return c(t,3,e),e}static mul(t,e){const s=this.empty();return h(t,e,4,s),s}static scale(t,e){const s=this.empty();return s.set(0,t.get(0)*e.x),s.set(1,t.get(1)*e.x),s.set(2,t.get(2)*e.x),s.set(3,t.get(3)*e.x),s.set(4,t.get(4)*e.y),s.set(5,t.get(5)*e.y),s.set(6,t.get(6)*e.y),s.set(7,t.get(7)*e.y),s.set(8,t.get(8)*e.z),s.set(9,t.get(9)*e.z),s.set(10,t.get(10)*e.z),s.set(11,t.get(11)*e.z),s.set(12,t.get(12)*e.w),s.set(13,t.get(13)*e.w),s.set(14,t.get(14)*e.w),s.set(15,t.get(15)*e.w),s}static lookAt(t,e,s){const r=a.normalize(a.sub(t,e)),i=a.normalize(a.crossProduct(s,r)),n=a.normalize(a.crossProduct(r,i)),c=this.empty();return c.set(0,i.x),c.set(1,i.y),c.set(2,i.z),c.set(3,0),c.set(4,n.x),c.set(5,n.y),c.set(6,n.z),c.set(7,0),c.set(8,r.x),c.set(9,r.y),c.set(10,r.z),c.set(11,0),c.set(12,t.x),c.set(13,t.y),c.set(14,t.z),c.set(15,1),c}static translate(t,e,s,r){return this.mul(t,this.createTranslation(e,s,r))}static rotateX(t,e){return this.mul(t,this.createRotationX(e))}static rotateY(t,e){return this.mul(t,this.createRotationY(e))}static rotateZ(t,e){return this.mul(t,this.createRotationZ(e))}static rotateAxis(t,e,s){return this.mul(t,this.createAxisRotation(e,s))}static scaleWithScalingMat(t,e){return e instanceof a?this.mul(t,this.createScalingMat(e)):this.mul(t,e)}static determinate(t){const e=t.get(10)*t.get(15),s=t.get(14)*t.get(11),r=t.get(6)*t.get(15),i=t.get(14)*t.get(7),a=t.get(6)*t.get(11),n=t.get(10)*t.get(7),c=t.get(2)*t.get(15),h=t.get(14)*t.get(3),o=t.get(2)*t.get(11),g=t.get(10)*t.get(3),u=t.get(2)*t.get(7),y=t.get(6)*t.get(3),m=e*t.get(5)+i*t.get(9)+a*t.get(13)-(s*t.get(5)+r*t.get(9)+n*t.get(13)),l=s*t.get(1)+c*t.get(9)+g*t.get(13)-(e*t.get(1)+h*t.get(9)+o*t.get(13)),x=r*t.get(1)+h*t.get(5)+u*t.get(13)-(i*t.get(1)+c*t.get(5)+y*t.get(13)),z=n*t.get(1)+o*t.get(5)+y*t.get(9)-(a*t.get(1)+g*t.get(5)+u*t.get(9));return 1/(t.get(0)*m+t.get(4)*l+t.get(8)*x+t.get(12)*z)}static inverse(t){const e=this.empty(),s=t.get(0),r=t.get(1),i=t.get(2),a=t.get(3),n=t.get(4),c=t.get(5),h=t.get(6),o=t.get(7),g=t.get(8),u=t.get(9),y=t.get(10),m=t.get(11),l=t.get(12),x=t.get(13),z=t.get(14),w=t.get(15),p=y*w,v=z*m,f=h*w,d=z*o,M=h*m,b=y*o,S=i*w,A=z*a,F=i*m,P=y*a,q=i*o,R=h*a,C=g*x,T=l*u,_=n*x,I=l*c,L=n*u,E=g*c,W=s*x,U=l*r,Z=s*u,N=g*r,Y=s*c,G=n*r,O=p*c+d*u+M*x-(v*c+f*u+b*x),V=v*r+S*u+P*x-(p*r+A*u+F*x),X=f*r+A*c+q*x-(d*r+S*c+R*x),j=b*r+F*c+R*u-(M*r+P*c+q*u),D=v*n+f*g+b*l-(p*n+d*g+M*l),k=p*s+A*g+F*l-(v*s+S*g+P*l),B=d*s+S*n+R*l-(f*s+A*n+q*l),H=M*s+P*n+q*g-(b*s+F*n+R*g),K=C*o+I*m+L*w-(T*o+_*m+E*w),Q=T*a+W*m+N*w-(C*a+U*m+Z*w),J=_*a+U*o+Y*w-(I*a+W*o+G*w),$=E*a+Z*o+G*m-(L*a+N*o+Y*m),tt=_*y+E*z+T*h-(L*z+C*h+I*y),et=Z*z+C*i+U*y-(W*y+N*z+T*i),st=W*h+G*z+I*i-(Y*z+_*i+U*h),rt=Y*y+L*i+N*h-(Z*h+G*y+E*i),it=1/(s*O+n*V+g*X+l*j);return e.set(0,it*O),e.set(1,it*V),e.set(2,it*X),e.set(3,it*j),e.set(4,it*D),e.set(5,it*k),e.set(6,it*B),e.set(7,it*H),e.set(8,it*K),e.set(9,it*Q),e.set(10,it*J),e.set(11,it*$),e.set(12,it*tt),e.set(13,it*et),e.set(14,it*st),e.set(15,it*rt),e}}function y(t,e){const s=Math.abs(t),r=Math.abs(e);return 0===t?Math.log(r):0===e?Math.log(s):s<3e3&&r<3e3?.5*Math.log(t*t+e*e):Math.log(t/Math.cos(Math.atan2(e,t)))}class m{constructor(t){return this.vec=new r(4),this.vec[0]=1,this.vec[1]=0,this.vec[2]=0,this.vec[3]=0,t?t instanceof m||t instanceof n?(this.vec[0]=t.get(0),this.vec[1]=t.get(1),this.vec[2]=t.get(2),this.vec[3]=t.get(3),this):t instanceof r?(this.vec[0]=t[0],this.vec[1]=t[1],this.vec[2]=t[2],this.vec[3]=t[3],this):this:this}get w(){return this.vec[0]}get x(){return this.vec[1]}get y(){return this.vec[2]}get z(){return this.vec[3]}size(){return this.vec.length}iterate(t){try{for(let e=0;e<this.vec.length;e++)t(e,this.vec[e])}catch(t){console.log(t)}}toString(){return this.vec.toString()}toArray(){return this.vec.slice()}toVec4(){return n.create(this.w,this.x,this.y,this.z)}toMat3(){const t=g.empty(),e=m.normSquared(this),s=0===e?0:2/e,r=s*this.w*this.x,i=s*this.w*this.y,a=s*this.w*this.z,n=s*this.x*this.x,c=s*this.x*this.y,h=s*this.x*this.z,o=s*this.y*this.y,u=s*this.y*this.z,y=s*this.z*this.z;return t.set(0,1-(o+y)),t.set(1,c-a),t.set(2,h+i),t.set(3,c+a),t.set(4,1-(n+y)),t.set(5,u-r),t.set(6,h-i),t.set(7,u+r),t.set(8,1-(n+o)),t}toMat4(){const t=u.empty(),e=m.normSquared(this),s=0===e?0:2/e,r=s*this.w*this.x,i=s*this.w*this.y,a=s*this.w*this.z,n=s*this.x*this.x,c=s*this.x*this.y,h=s*this.x*this.z,o=s*this.y*this.y,g=s*this.y*this.z,y=s*this.z*this.z;return t.set(0,1-(o+y)),t.set(1,c-a),t.set(2,h+i),t.set(3,0),t.set(4,c+a),t.set(5,1-(n+y)),t.set(6,g-r),t.set(7,0),t.set(8,h-i),t.set(9,g+r),t.set(10,1-(n+o)),t.set(11,0),t.set(12,0),t.set(13,0),t.set(14,0),t.set(15,1),t}getReal(){return this.w}getImaginary(){return a.create(this.x,this.y,this.z)}get(t){try{return this.vec[t]}catch(t){return 0}}set(t,e){"number"==typeof t&&"number"==typeof e&&(t>3||(this.vec[t]=e))}isFinite(){return isFinite(this.w)&&isFinite(this.x)&&isFinite(this.y)&&isFinite(this.z)}isNaN(){return isNaN(this.w)||isNaN(this.x)||isNaN(this.y)||isNaN(this.z)}rotateVec3(t){const e=2*(this.y*t.z-this.z*t.y),s=2*(this.z*t.x-this.x*t.z),r=2*(this.x*t.y-this.y*t.x);return a.create(t.x+this.w*e+this.y*r-this.z*s,t.y+this.w*s+this.z*e-this.x*r,t.z+this.w*r+this.x*s-this.y*e)}static getConstructionObject(){return r}static copy(t){try{return new m(t)}catch(t){return null}}static empty(){return new m}static create(t,e,s,r){const i=this.empty();return i.set(0,t),i.set(1,e),i.set(2,s),i.set(3,r),i}static createZero(){const t=this.empty();return t.set(0,0),t}static createFromAxisAngle(t,e){const s=.5*e,r=Math.sin(s)/Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z);return this.create(Math.cos(s),t.x*r,t.y*r,t.z*r)}static createFromBetweenVectors(t,e){const s=t.x*e.x+t.y*e.y+t.z*e.z,r=t.y*e.z-t.z*e.y,i=t.z*e.x-t.x*e.z,a=t.x*e.y-t.y*e.x,n=this.create(s+Math.sqrt(s*s+r*r+i*i+a*a),r,i,a);return this.normalize(n)}static createRandom(){const t=Math.random(),e=Math.random(),s=Math.random(),r=Math.sqrt(1-t),i=Math.sqrt(t);return this.create(i*Math.cos(2*Math.PI*s),r*Math.sin(2*Math.PI*e),r*Math.cos(2*Math.PI*e),i*Math.sin(2*Math.PI*s))}static createFromRotationMatrix(t){const e=t.get(0)+t.get(5)+t.get(10);if(e>0){const s=.5/Math.sqrt(e+1);return this.create(.25/s,(t.get(6)-t.get(9))*s,(t.get(8)-t.get(2))*s,(t.get(1)-t.get(4))*s)}if(t.get(0)>t.get(5)&&t.get(0)>t.get(10)){const e=2*Math.sqrt(1+t.get(0)-t.get(5)-t.get(10));return this.create((t.get(6)-t.get(9))/e,.25*e,(t.get(4)+t.get(1))/e,(t.get(8)+t.get(2))/e)}if(t.get(5)>t.get(10)){const e=2*Math.sqrt(1+t.get(5)-t.get(0)-t.get(10));return this.create((t.get(8)-t.get(2))/e,(t.get(4)+t.get(1))/e,.25*e,(t.get(9)+t.get(6))/e)}const s=2*Math.sqrt(1+t.get(10)-t.get(0)-t.get(5));return this.create((t.get(1)-t.get(4))/s,(t.get(8)+t.get(2))/s,(t.get(9)+t.get(6))/s,.25*s)}static createFromEuler(t,e,s,r){const i=.5*t,a=.5*e,n=.5*s,c=Math.cos(i),h=Math.cos(a),o=Math.cos(n),g=Math.sin(i),u=Math.sin(a),y=Math.sin(n);return r&&"ZXY"!==r?"XYZ"===r||"RPY"===r?this.create(c*h*o-g*u*y,h*o*g+c*u*y,c*o*u-h*g*y,c*h*y+o*g*u):"YXZ"===r?this.create(c*h*o+g*u*y,c*o*u+h*g*y,h*o*g-c*u*y,c*h*y-o*g*u):"ZYX"===r||"YPR"===r?this.create(c*h*o+g*u*y,c*h*y-o*g*u,c*o*u+h*g*y,h*o*g-c*u*y):"YZX"===r?this.create(c*h*o-g*u*y,c*h*y+o*g*u,h*o*g+c*u*y,c*o*u-h*g*y):"XZY"===r?this.create(c*h*o+g*u*y,h*o*g-c*u*y,c*h*y-o*g*u,c*o*u+h*g*y):this.create(c*h*o-g*u*y,c*o*u-h*g*y,c*h*y+o*g*u,h*o*g+c*u*y):this.create(c*h*o-g*u*y,c*o*u-h*g*y,c*h*y+o*g*u,h*o*g+c*u*y)}static add(t,e){return this.create(t.w+e.w,t.x+e.x,t.y+e.y,t.z+e.z)}static sub(t,e){return this.create(t.w-e.w,t.x-e.x,t.y-e.y,t.z-e.z)}static normSquared(t){return t.w*t.w+t.x*t.x+t.y*t.y+t.z*t.z}static norm(t){return Math.sqrt(this.normSquared(t))}static normalize(t){let e=this.norm(t);return e<1e-16?this.createZero():(e=1/e,this.create(t.w*e,t.x*e,t.y*e,t.z*e))}static negate(t){return this.create(0-t.w,0-t.x,0-t.y,0-t.z)}static mul(t,e){return this.create(t.w*e.w-t.x*e.x-t.y*e.y-t.z*e.z,t.w*e.x+t.x*e.w+t.y*e.z-t.z*e.y,t.w*e.y+t.y*e.w+t.z*e.x-t.x*e.z,t.w*e.z+t.z*e.w+t.x*e.y-t.y*e.x)}static scale(t,e){return this.create(e*t.w,e*t.x,e*t.y,e*t.z)}static inverse(t){let e=this.normSquared(t);return 0===e?this.createZero():(e=1/e,this.create(t.w*e,(0-t.x)*e,(0-t.y)*e,(0-t.z)*e))}static div(t,e){let s=this.normSquared(e);return 0===s?this.createZero():(s=1/s,this.create((t.w*e.w+t.x*e.x+t.y*e.y+t.z*e.z)*s,(t.x*e.w-t.w*e.x-t.y*e.z+t.z*e.y)*s,(t.y*e.w-t.w*e.y-t.z*e.x+t.x*e.z)*s,(t.z*e.w-t.w*e.z-t.x*e.y+t.y*e.x)*s))}static conjugate(t){return this.create(t.w,0-t.x,0-t.y,0-t.z)}static exp(t){const e=Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z),s=Math.exp(t.w),r=s/e*Math.sin(e);return 0===e?this.create(s,0,0,0):this.create(s*Math.cos(e),t.x*r,t.y*r,t.z*r)}static log(t){if(0===t.y&&0===t.z)return this.create(y(t.w,t.x),Math.atan2(t.x,t.w),0,0);const e=this.normSquared(t),s=Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z),r=Math.atan2(s,t.w)/s;return this.create(.5*Math.log(e),t.x*r,t.y*r,t.z*r)}static pow(t,e){if(0!==e.y||0!==e.z)return this.exp(this.mul(this.log(t),e));if(1===e.w&&0===e.x)return this.create(t.w,t.x,t.y,t.z);if(0===e.w&&0===e.x)return this.empty();if(0===t.y&&0===t.z){if(0===t.w&&0===t.x)return this.createZero();if(0===e.x){if(0===t.x&&t.w>=0)return this.create(Math.pow(t.w,e.w),0,0,0);if(0===t.w)switch(e.w%4){case 0:return this.create(Math.pow(t.x,e.w),0,0,0);case 1:return this.create(0,Math.pow(t.x,e.w),0,0);case 2:return this.create(-Math.pow(t.x,e.w),0,0,0);case 3:return this.create(0,-Math.pow(t.x,e.w),0,0)}}const s=Math.atan2(t.x,t.w),r=y(t.w,t.x),i=Math.exp(e.w*r-e.x*s),a=e.x*r+e.w*s;return this.create(i*Math.cos(a),i*Math.sin(a),0,0)}return this.exp(this.mul(this.log(t),e))}static slerp(t,e,s){let r=t.w,i=t.x,a=t.y,n=t.z,c=e.w,h=e.x,o=e.y,g=e.z,u=r*c+i*h+a*o+n*g;if(u<0&&(r=-r,i=-i,a=-a,n=-n,u=-u),u>.9995){const t=this.create(r+s*(c-r),i+s*(h-i),a+s*(o-a),n+s*(g-n));return this.normalize(t)}const y=Math.acos(u),m=Math.sin(y),l=y*s,x=Math.sin(l),z=Math.cos(l)-u*x/m,w=x/m;return this.create(z*r+w*c,z*i+w*h,z*a+w*o,z*n+w*g)}}function l(){}class x{constructor(t){this.register(t)}register(t){"function"!=typeof t&&(t=l),this.fn=t}performCall(...t){var e;try{return null===(e=this.fn)||void 0===e?void 0:e.apply(null,arguments)}catch(t){console.error(t)}}}let z=!0,w=!1,p=!1,v=0,f=0,d=0,M=0;const b=new x(l),S=new x(l);function A(t){z||(w||(d=t-v,M=t-f,f=t,S.performCall(t,p?0:M,d)),requestAnimationFrame(A))}const F={1e3:[255,56,0],1500:[255,109,0],1900:[255,131,0],2e3:[255,137,18],2200:[255,147,44],2500:[255,161,72],2700:[255,169,87],2800:[255,173,94],2900:[255,177,101],3e3:[255,180,107],3500:[255,196,137],4e3:[255,209,163],4100:[255,211,168],4300:[255,215,177],4500:[255,219,186],5e3:[255,228,206],5100:[255,230,210],5200:[255,232,213],5300:[255,233,217],5400:[255,235,220],5500:[255,236,224],5600:[255,238,227],5700:[255,239,230],6e3:[255,243,239],6500:[255,249,253],6600:[254,249,255],6700:[252,247,255],6800:[249,246,255],6900:[247,245,255],7e3:[245,243,255],7100:[243,242,255],7200:[240,241,255],7300:[239,240,255],7400:[237,239,255],7500:[235,238,255],8e3:[227,233,255],8500:[220,229,255],9e3:[214,225,255],9300:[210,223,255],9500:[208,222,255],9600:[207,221,255],9700:[207,221,255],9800:[206,220,255],9900:[205,220,255],1e4:[204,219,255],10500:[200,217,255],11e3:[200,213,255],11500:[193,213,255],12e3:[191,211,255],12500:[188,210,255],13e3:[186,208,255],13500:[184,207,255],14e3:[182,206,255],14500:[180,205,255],15e3:[179,204,255],15500:[177,203,255],16e3:[176,202,255],16500:[175,201,255],17e3:[174,200,255],17500:[173,200,255]},P=!!WebGLRenderingContext,q=!!WebGL2RenderingContext;class R{constructor(t,e){if(this._canvas=R.createCanvas(),this._programs=new Map,this._programInUse="",1==t&&0==R.verifyWebGl2())throw"WebGL2 not supported!";R.verifyWebGl2()?this._gl=R.createWebgl2(this.canvas,e):R.verifyWebGl1()&&(this._gl=R.createWebgl1(this.canvas,e))}static radToDeg(t){return 180*t/Math.PI}static degToRad(t){return t*Math.PI/180}static colorTemperatureToRgb(t){let e=255,r=1255,i=255;return"number"==typeof t&&t?(t<0&&(t=0),0==t?a.create(255,255,255):F[t]?a.create(F[t][0],F[t][1],F[t][2]):((t/=100)<=66?(e=255,r=parseFloat((99.4708025861*Math.log(t)-161.1195681661).toFixed(0))):(e=parseFloat((329.698727446*Math.pow(t-60,-.1332047592)).toFixed(0)),r=parseFloat((288.1221695283*Math.pow(t-60,-.0755148492)).toFixed(0))),i=t>=66?255:t<=19?0:parseFloat((138.5177312231*Math.log(t-10)-305.0447927307).toFixed(0)),a.create(s(e),s(r),s(i)))):a.create(255,255,255)}static compose(t,e,s){const r=e.x,i=e.y,a=e.z,n=e.w,c=r+r,h=i+i,o=a+a,g=r*c,y=r*h,m=r*o,l=i*h,x=i*o,z=a*o,w=n*c,p=n*h,v=n*o,f=s.x,d=s.y,M=s.z,b=u.empty();return b.set(0,(1-(l+z))*f),b.set(1,(y+v)*f),b.set(2,(m-p)*f),b.set(3,0),b.set(4,(y-v)*d),b.set(5,(1-(g+z))*d),b.set(6,(x+w)*d),b.set(7,0),b.set(8,(m+p)*M),b.set(9,(x-w)*M),b.set(10,(1-(g+l))*M),b.set(11,0),b.set(12,t.x),b.set(13,t.y),b.set(14,t.z),b.set(15,1),b}static verifyWebGl1(){return P}static verifyWebGl2(){return q&&!0}static createCanvas(){let t=document.createElement("canvas");return t.innerHTML="This browser does not support HTML5",t}static createWebgl1(t,e){if(0==R.verifyWebGl1())return null;t||(t=R.createCanvas());let s=t.getContext("webgl",e);if(!s)throw new Error("Could not get context, there was an unknown error.");return s}static createWebgl2(t,e){if(0==R.verifyWebGl2())return null;t||(t=R.createCanvas());let s=t.getContext("webgl2",e);if(!s)throw new Error("Could not get context, there was an unknown error.");return s}static createProgram(t,e,s){let r=t.createProgram();if(t.attachShader(r,e),t.attachShader(r,s),t.linkProgram(r),!t.getProgramParameter(r,t.LINK_STATUS))throw"Program failed to link: "+t.getProgramInfoLog(r);return r}static webglResize(t,e,s){t.canvas.width=e,t.canvas.height=s,t.viewport(0,0,t.canvas.width,t.canvas.height),t.clearColor(1,1,1,1),t.clearDepth(1),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT)}static compileShader(t,e,s){let r=t.createShader(e);if(t.shaderSource(r,s),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS))throw t.deleteShader(r),"Could not compile shader: "+t.getShaderInfoLog(r);return r}static setRectangle(t,e,s,r,i){const a=e,n=e+r,c=s,h=s+i;t.bufferData(t.ARRAY_BUFFER,new Float32Array([a,c,n,c,a,h,a,h,n,c,n,h]),t.STATIC_DRAW)}get canvas(){return this._canvas}get gl(){return this._gl}get program(){return this._programs.get(this._programInUse)}resize(t,e){R.webglResize(this.gl,t,e)}createProgram(t,e,s){try{const r=R.createProgram(this.gl,R.compileShader(this.gl,this.gl.VERTEX_SHADER,e),R.compileShader(this.gl,this.gl.FRAGMENT_SHADER,s));this._programInUse=t,this._programs.set(this._programInUse,r)}catch(t){console.error(t)}}enableDepthTest(){this.gl.enable(this.gl.DEPTH_TEST)}enableCullFace(){this.gl.enable(this.gl.CULL_FACE)}setUniforms(t){for(let e of t)try{const t=this.gl.getUniformLocation(this.program,e.name),s="uniform"+e.type;this.gl[s].apply(this.gl,[t,e.value])}catch(t){console.error(t)}}useProgram(t){this._programInUse=t}}R.Vec2=i,R.Vec3=a,R.Vec4=n,R.Mat2=o,R.Mat3=g,R.Mat4=u,R.Quaternion=m,R.onStartFrame=function(t){b.register(t)},R.onUpdateFrame=function(t){S.register(t)},R.startFrames=function(){requestAnimationFrame((t=>{0!=z&&(z=!1,w=!1,p=!1,v=t,f=t,d=0,M=0,b.performCall(0,0),requestAnimationFrame(A))}))},R.pauseFrames=function(){p=!0},R.unpauseFrames=function(){p=!1},R.stopFrames=function(){w=!0},R.resumeFrames=function(){w=!1},R.killFrames=function(){z=!0};const C=R;var T="WebglUtility";try{if(e()[T])throw new Error('window["'+T+'"] is already in use!');e()[T]=C}catch(t){console.error(t)}})();
